# 詳細_第4章_多クラス分類の評価指標
#書籍詳細 #評価指標 #多クラス分類 #機械学習 #Micro #Macro #Weighted

## 概要
この章では、3つ以上のクラスにデータを分類する多クラス分類問題と、その評価指標について解説されています。二値分類の拡張として、より複雑な分類タスクにおける評価方法が示されています。

## 主な内容

### 4.1 多クラス分類とは
**多クラス分類**は、データを3つ以上の独立したクラスに分類するタスクであると定義されています。

**応用例**：
- **手書き数字の認識**
- **ユーザーのWebページの閲覧履歴からのカテゴリ判別**
- **ニュース記事の自動分類**
- **監視カメラの映像データからの年齢・性別・年代分類**

### 4.2 データセット
Kaggleの「Customer Segmentation」データセットを用いて、多クラス分類モデルの評価が説明されています。

データセットは、顧客を年齢、性別、職業、居住地、消費行動などに基づいて4つのセグメントに分類することを目的としていることが示されています。

### 4.3 混同行列
二値分類と同様に、多クラス分類においても**混同行列**がモデルの予測結果と真のクラスを比較するために用いられます。

多クラス分類の混同行列は、各クラスの**TP, FP, FN, TN**を視覚的に表現し、モデルの性能を詳細に分析するのに役立ちます。

### 4.4 正解率 (Accuracy)
多クラス分類における正解率は、すべての予測結果のうち**正しく分類されたデータの割合**を示す指標です。

**注意点**：クラスの不均衡がある場合、正解率だけではモデルの性能を正確に評価できない可能性があることが指摘されています。

### 4.5 適合率 (Precision)
多クラス分類では、**Micro Precision, Macro Precision, Weighted Precision**の3つの方法で適合率を計算する方法が紹介されています。

**計算方法**：
- **Micro Precision**：すべてのクラスのTPとFPを合計して計算される全体的な適合率
- **Macro Precision**：各クラスの適合率の**単純平均**
- **Weighted Precision**：各クラスの適合率を**サンプル数で重み付け**した平均

### 4.6 再現率 (Recall)
多クラス分類では、適合率と同様に、**Micro Recall, Macro Recall, Weighted Recall**の3つの方法で再現率を計算する方法が紹介されています。

これらの指標は、クラスの不均衡や各クラスの重要度に応じて使い分けることが推奨されています。

### 4.7 F1-score
多クラス分類では、F1-scoreも適合率と同様に**Micro F1-score, Macro F1-score, Weighted F1-score**の3つの方法で計算されます。

F1-scoreは、適合率と再現率のバランスを評価する指標として重要です。

### 4.8 ROC-AUC
多クラス分類におけるROC-AUCは、各クラスをPositiveとそれ以外のクラスをNegativeとする**二値分類問題の集合**として扱われます。

**計算方法**：
- **Micro ROC-AUC**：すべてのクラスのTP/FPを合計して全体的なAUCを計算
- **Macro ROC-AUC**：各クラスのROC曲線を**単純平均**してAUCを計算

**注意点**：クラスの不均衡がある場合、MicroとMacroのAUC値が大きく異なることがあるため、両方の指標を確認し、ビジネスインパクトを考慮して最適な指標を選択することが推奨されています。

### 4.9 最適な評価指標の考察
多クラス分類においても、単に数値的な評価指標だけでなく、**ビジネス目標**に合わせた評価指標の選定が重要であると強調されています。

#### 4.9.1 ビジネスインパクトの期待値計算
多クラス分類においても、各クラスの誤分類コストと利益を考慮して**ビジネスインパクトの期待値**を計算する方法が解説されています。

例えば、顧客セグメントのケースでは、異なるセグメントにメールを送った場合の**期待利益**を計算し、モデルの予測がビジネスに与える経済的影響を評価する具体例が示されています。

### 4.10 まとめ
本章では、多クラス分類における様々な評価指標が紹介され、クラスの不均衡やビジネスインパクトを考慮した評価指標の選定と最適化の重要性がまとめられています。

---

関連：[[05_Bookmemo/評価指標入門/章ごとのまとめ]] | [[詳細_第3章_二値分類における評価指標]] | [[詳細_付録_ビジネス構造の数理モデリング]]