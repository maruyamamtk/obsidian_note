# 詳細_第3章_二値分類における評価指標
#書籍詳細 #評価指標 #二値分類 #機械学習 #混同行列 #精度 #適合率 #再現率 #F1-score #ROC-AUC

## 概要
この章では、二値分類問題に特化した評価指標について詳細に解説されています。混同行列を基盤として、様々な評価指標の特徴と適用場面が示されています。

## 主な内容

### 3.1 二値分類と評価指標
**二値分類**は、データを2つのクラス（例：Positive/Negative）に分類するタスクであり、機械学習の基礎的な問題の一つです。

**応用例**：
- **広告メールの自動配信**
- **不正取引の検出**
- **製品の異常検出**

「**ビジネス目的**」を考慮して評価指標を選択する必要があると強調されています。

### 3.2 データセット
Kaggleの「Employee Promotion Data」データセットを用いて、二値分類モデルの評価が説明されています。

データセットの構造と各カラムの意味が説明されており、従業員の昇進予測を目的としていることが示されています。

### 3.3 混同行列 (Confusion Matrix)
混同行列は、二値分類モデルの予測結果と真のクラスをまとめた表であり、以下の4つの要素から構成されます：
- **True Positive (TP)**
- **True Negative (TN)**
- **False Positive (FP)**
- **False Negative (FN)**

混同行列は、モデルの**性能を詳細に分析**するための基本的なツールです。

### 3.4 正解率 (Accuracy)
正解率は、すべての予測結果のうち**正しく分類された割合**を示す指標です。

**注意点**：データセットのクラス分布が不均衡な場合、正解率だけではモデルの性能を適切に評価できない可能性があることが指摘されています。

### 3.5 マシューズ相関係数 (Matthews Correlation Coefficient: MCC)
MCCは、**正解率の課題**を克服するために導入された指標で、TP, TN, FP, FNの4つの要素すべてを考慮し、**クラスの不均衡**に強いとされています。

**特徴**：
- -1から+1の範囲で値を取る
- +1が完全な予測
- 0がランダムな予測
- -1が完全な誤予測

### 3.6 適合率 (Precision)
適合率は、モデルが**Positiveと予測した**ケースのうち、実際に**Positiveであった割合**を示す指標です。

**適用場面**：**誤ってPositiveと予測する（FP）ことを避けたい**場合に特に有用

### 3.7 再現率 (Recall)
再現率は、実際に**Positiveであった**ケースのうち、モデルが**Positiveと正しく予測できた割合**を示す指標です。

**適用場面**：**Positiveなケースを見逃したくない（FNを減らしたい）**場合に特に有用

### 3.8 F1-score
F1-scoreは、**適合率と再現率の調和平均**であり、両方のバランスを考慮したい場合に用いられる指標です。

特に**クラスの不均衡**があるデータセットで、適合率と再現率のどちらも重視したい場合に有効であると説明されています。

### 3.9 G-Mean
G-Meanは、**True Positive Rate (TPR)**と**True Negative Rate (TNR)**の幾何平均であり、PositiveクラスとNegativeクラスの**両方の予測性能のバランス**を評価する指標です。

### 3.10 ROC-AUC (Receiver Operating Characteristic - Area Under the Curve)
ROC-AUCは、様々な閾値における**TPRとFalse Positive Rate (FPR)**の関係を示す曲線（ROC曲線）の下の面積です。

**特徴**：
- **クラスの不均衡なデータ**セットにおいて、**モデルの分類性能全体**を評価するのに適している
- AUC値が1.0に近いほど優れたモデル

### 3.11 PR-AUC (Precision-Recall AUC)
PR-AUCは、**PrecisionとRecallの関係**を示すPR曲線の下の面積です。

**Positiveクラスのデータ数が少ない（不均衡データ）**場合に、ROC-AUCよりも**モデルの性能をより適切に評価できる**と強調されています。

### 3.12 pAUC (partial AUC)
pAUCは、**ROC曲線またはPR曲線の一部分**に限定してAUCを計算する指標で、特定のFPR範囲やRecall範囲でモデルの性能を評価したい場合に用いられます。

**適用例**：**広告のクリック率予測**など、**低FPRの範囲で高い性能**が求められる場合

### 3.13 Employee Promotion Data データセットの評価
これまでに紹介された評価指標（Accuracy, MCC, Precision, Recall, F1-score, G-Mean, ROC-AUC, PR-AUC, pAUC）を用いて、Employee Promotion Dataセットのモデル評価結果がまとめられています。

評価指標の数値だけでなく、**ビジネス目標**（例：昇進させるべきではない人を誤って昇進させない、コスト削減）を考慮して、どの指標が重要かを判断する必要があることが強調されています。

### 3.14 ビジネスインパクトの期待値計算
機械学習モデルの予測結果がビジネスに与える**経済的な影響**を評価する方法が解説されています。

**True Positive, False Positive, True Negative, False Negative**の各ケースで発生する**コストと利益**を定義し、それに基づいて**モデルの期待利益**を計算する具体例が示されています。

例えば、DM送付のケースでは、DMを送った結果の利益と送らなかった場合の利益を比較し、**期待利益が最大化する**ようにモデルを評価することが重要であると説明されています。

### 3.15 コスト考慮型学習 (Cost-Sensitive Learning)
**コスト考慮型学習**は、分類タスクにおいて、誤分類のコストを考慮してモデルを学習させる手法です。

**アプローチ**：
- **直接法 (Direct Method)**
- **コスト考慮型メタ学習法 (Cost-sensitive Meta-learning Method)**

誤分類コストに基づいてデータに**重み付け**をしたり、**サンプリング**を行ったりすることで、モデルが**ビジネス目標に沿った性能**を発揮するように調整する方法が説明されています。

### 3.16 まとめ
本章では、二値分類における様々な評価指標が紹介され、特に**ビジネスインパクト**を考慮した評価指標の選定とコスト考慮型学習の重要性が強調されています。

---

関連：[[05_Bookmemo/評価指標入門/章ごとのまとめ]] | [[詳細_第2章_回帰の評価指標]] | [[詳細_第4章_多クラス分類の評価指標]]