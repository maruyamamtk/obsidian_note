# 詳細_第3章 認知形成を数理モデリングする

#製品認知 #ベータ分布 #認知カーブ #FrequencyEstimator #AwarenessCurveEstimator

## 製品認知の数理モデリング

この章では、企業が広告を通じて製品認知を高める際の**製品認知の形成を数理的にモデリングし、最適化**するアプローチを詳細に解説しています。

## ステップ1：製品認知最適化問題の定式化

### 認知目標達成のための最小CM出稿量決定

認知目標を効率的に達成するための最適化問題：

$$\min g \quad \text{s.t.} \quad Pr(A=1|g) \geq \text{target}$$

### 予算制約下での認知率最大化

与えられた予算内で製品認知率を最大化する問題：

$$\max Pr(A=1|g)$$

subject to:
- $100kg \leq b$（予算制約）  
- $g \geq 0$（非負制約）

where:
- **決定変数**：$g$（CM出稿量）
- **目的関数**：$Pr(A=1|g)$（製品認知率）

## ステップ2：認知メカニズムの数理モデル構築

### 機械学習モデルによる認知カーブ推定

#### ランダムフォレスト
非線形な関係性を捉えるための機械学習アプローチ。

#### 対数線形回帰モデル
$$Pr(A=1|g) = \alpha + \beta \log(g+1)$$

この対数変換により、CM出稿量の逓減効果を表現できます。

### ベータ分布による個人レベルモデリング

#### 個人ごとの製品認知メカニズム

製品を認知している個人のCM接触回数と非認知個人のCM接触回数の比率が**ベータ分布**に従うと仮定：

$$\text{Ratio} \sim \text{Beta}(\alpha, \beta)$$

#### 製品認知率の積分表現

ベータ分布の平均を用いた製品認知率の表現：

$$Pr(A=1|g) = \int_0^1 p \cdot f_{\text{Beta}}(p; \alpha, \beta) dp = \frac{\alpha}{\alpha + \beta}$$

where:
- $\mu = \frac{\alpha}{\alpha + \beta}$：ベータ分布の平均

### Pythonクラスによる実装

#### FrequencyEstimatorクラス

CM接触回数の分布推定を行うクラス：

```python
class FrequencyEstimator:
    def __init__(self):
        self.model = None
    
    def fit(self, data):
        # CM接触回数分布のパラメータ推定
        pass
    
    def predict(self, gross_reach):
        # グロスリーチからCM接触回数分布を予測
        pass
```

#### AwarenessCurveEstimatorクラス

認知カーブの推定を行うクラス：

```python
class AwarenessCurveEstimator:
    def __init__(self):
        self.awareness_model = None
        self.frequency_estimator = FrequencyEstimator()
    
    def fit(self, cm_data, awareness_data):
        # 認知カーブのパラメータ推定
        pass
    
    def predict_awareness(self, gross_reach):
        # グロスリーチから製品認知率を予測
        pass
```

## データ分析とモデル構築

### REVISIO社データの活用

実際のCM接触回数と製品認知率のデータを分析：

1. **CM接触回数データ**：個人レベルでのCM視聴履歴
2. **製品認知率データ**：調査による製品認知状況
3. **グロスリーチデータ**：CM出稿量と総接触回数の関係

### データ前処理と特徴量エンジニアリング

認知カーブの精度向上のための前処理：

- **外れ値の処理**
- **欠損値の補完**  
- **対数変換による正規化**
- **カテゴリカル変数のエンコーディング**

## ステップ3：最適CM出稿量の決定

### Scipyを用いた最適化

```python
from scipy import optimize

def objective_function(g):
    # 認知率からコストを差し引いた目的関数
    awareness_rate = awareness_model.predict(g)
    cost = cost_per_grp * g
    return -(awareness_rate - cost_weight * cost)

# 最適化実行
result = optimize.minimize(objective_function, 
                         initial_guess, 
                         method='L-BFGS-B',
                         bounds=[(0, max_grp)])

optimal_grp = result.x[0]
```

### 制約条件を考慮した最適化

複数の制約条件を同時に満たす解の探索：

1. **予算制約**：$\text{cost}(g) \leq \text{budget}$
2. **認知目標制約**：$Pr(A=1|g) \geq \text{target}$  
3. **出稿量制約**：$g_{\min} \leq g \leq g_{\max}$

## 認知形成の理論的背景

### 学習理論との関連

製品認知の形成プロセスは、学習理論における以下の概念と関連：

- **反復学習効果**：CM接触回数の増加による認知向上
- **忘却曲線**：時間経過による認知率の減衰
- **閾値効果**：認知形成に必要な最小接触回数

### 心理学的モデリング

認知心理学の知見を数理モデルに組み込み：

- **注意資源の配分**
- **記憶の符号化プロセス**
- **態度変容のメカニズム**

## 実用的な応用と展開

### リアルタイム最適化

構築されたモデルを用いた動的な最適化：

1. **日次データ更新**によるモデル再学習
2. **A/Bテスト**による施策効果検証
3. **多変量最適化**による複数指標の同時最適化

### セグメント別最適化

ターゲット層に応じた個別最適化：

- **年代別認知カーブ**の推定
- **性別・地域別**の出稿戦略
- **ライフスタイル**に基づく認知モデル

---

**戻る**：[[章ごとのまとめ]]

**前章**：[[詳細_第2章 マーケティングにデータサイエンスを導入する]]

**次章**：[[詳細_第4章 連続最適化で広告予算を配分する]]
