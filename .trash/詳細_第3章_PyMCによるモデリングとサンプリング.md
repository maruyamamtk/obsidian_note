# 詳細_第3章_PyMCによるモデリングとサンプリング

## 確率的プログラミングライブラリPyMC

本章では、確率的プログラミングライブラリPyMC（特にPyMC3/PyMC4）を使った本格的なベイズモデリングが取り上げられます。PyMCは、モデル定義からサンプリング、可視化、収束評価までを一貫して行える強力なライブラリであり、業務や研究で広く利用されています。

## モデル構築とMCMC法

モデルの構築では、事前分布と尤度を明示的に記述し、観測データを通して事後分布をMCMC（Markov Chain Monte Carlo）法により近似します。特にNo-U-Turn Sampler（NUTS）アルゴリズムが標準的に用いられており、高次元空間でも効率的なサンプリングが可能です。

## 収束評価指標

モデルが適切に収束しているかを判断するために、以下の評価指標が重要となります：

### 主要指標
- **`mcse_mean`**: モンテカルロ標準誤差
  - 推定量のばらつきの大きさを示す
  - 目安：0.01以下

- **`ess_bulk`**: 有効サンプルサイズ
  - サンプルの独立性を示す
  - 目安：400以上が望ましい

- **`r_hat`**: Gelman-Rubin統計量
  - チェーン間の収束性を測る指標
  - 目安：1.01以下が基準

## 発散問題への対処

モデルが複雑な場合やデータにノイズが多い場合には、`divergence`（発散）が発生することがあり、これはサンプラーが高確率領域をうまく探索できていないことを示します。divergenceが頻発する場合は、事前分布の設定やモデル構造の見直しが必要になります。

← [[05_Bookmemo/Pythonでスラスラわかるベイズ推論「超」入門/章ごとのまとめ]] に戻る
