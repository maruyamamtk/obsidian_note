# ビジネス課題を解決する技術

以下に各章の要約を記載します。

- **第0章 はじめに** この章では、データサイエンスがビジネス課題解決において不可欠な技術となっている現状を述べ、本書の目的と構成が説明されています。本書が提案する**3ステップフレームワーク**は、ビジネス課題を数理最適化問題として定式化し、数理モデルを構築してデータから未知のパラメータを推定し、最終的に最適なアクションを導出するというものです。このフレームワークは、ビジネスにおける価値創造にデータサイエンスを結びつけたいすべての人に向けて書かれており、統計学、数理最適化、機械学習、Pythonプログラミングといった多岐にわたる知識を習得できることを目指しています。本書では、実ビジネスで実際に観測されたデータ（REVISIO社やテレビCMデータなど）を豊富に用いながら、ビジネス課題をデータサイエンスの観点から考察し、解決プロセスを提示しています。また、数式表記（例：期待値 `E[X]`、確率 `Pr(X)`、分散 `Var[X]`、集合 `X`、最大化 `max`、最小化 `min` など）やPythonコードの記法、本書で用いる確率分布（確率変数、ガンマ分布、ベータ分布、ベルヌーイ分布、二項分布、ポアソン分布、負の二項分布など）についても詳しく説明されており、読者が本書の内容を理解するための基礎知識が提供されています。
    
- **第1章 ビジネス課題を解決する技術** この章では、データサイエンスをビジネス課題解決に活用するための**3ステップフレームワークの全体像**が詳細に紹介されています。**ステップ1**では、ビジネス課題を「目的」「決定変数」「制約条件」を含む**数理最適化問題として明確に定式化**する方法が解説されます。具体例として、Web広告のABテストにおける利益最大化問題（目的関数 `max c(x)`、決定変数 `x`、制約条件 `s.t. x ∈ X`）や、営業チームの人員配置最適化問題（目的関数 `max p(x)`、決定変数 `x`、制約条件 `s.t. cx ≤ b, x ≥ 0`）、製品広告の最適化問題（目的関数 `max E[A|g] = Pr(A=1|g)`、決定変数 `g`、制約条件 `s.t. cx ≤ b, g ≥ 0`）などが挙げられています。**ステップ2**では、定式化された問題に含まれる**未知のパラメータをデータから推定するために、適切な数理モデルを構築**する手法が紹介されます。例えば、ABテストではクリック率の期待値 `E[C|X] = Pr(C=1|X=x)` を、営業チームでは利益の期待値 `E[P|x] = E[R|x] - E[C|x]` を、製品認知では製品認知率 `Pr(A=1|g)` をデータから推定するためのモデルを構築します。ここでは、線形回帰モデル `E[Y|X] = α + βX` や、非線形な関係性を表現する多項式回帰モデル `E[Y|X] = α + β₁X + β₂X² + β₃X³` など、様々な数理モデルの適用が示されています。**ステップ3**では、構築された数理モデルと定式化された最適化問題を活用し、**最適なビジネスアクションを導出**する具体的なプロセスが示されており、データサイエンスをビジネスの価値創造に繋げるための普遍的なアプローチを提示しています。
    
- **第2章 マーケティングにデータサイエンスを導入する** この章では、前章で紹介した3ステップフレームワークを、**テレビCMのマーケティング活動**という具体的なビジネス課題に適用する事例が詳細に解説されています。まず、テレビCMの効果測定において重要な「グロスリーチ（CMの出稿回数）」と「ユニークリーチ（CMの到達人数）」の概念が説明され、REVISIO社などの実際のデータを用いた分析手法が示されています。**ステップ1**では、CMの出稿量と利益の関係を最大化する**数理最適化問題として定式化**されます。具体的には、与えられた広告予算 `b` の制約のもとで、CM出稿量 `g` を決定し、利益の期待値 `E[P|g]` を最大化する問題（`max E[P|g] = Pr(R=1|g) * 100kg - 100kg * g`、制約条件 `100kg <= b, g >= 0`）として定義されます。**ステップ2**では、この最適化問題に必要な**「リーチカーブ」（CM出稿量とユニークリーチの関係）などの未知のパラメータをデータから推定するため、数理モデルが構築**されます。ここでは、ランダムフォレストや線形回帰（`E[R|g] = βg`）などの機械学習モデル、さらにグロスリーチとユニークリーチの関係を確率分布を用いてモデル化するアプローチが紹介されます。特に、CM接触回数がポアソン分布（`Pr(F=f) = (θ^f / f!) * exp(-θ)`、ユニークリーチ `r(g) = 1 - e^(-θ)`）や負の二項分布（ユニークリーチ `r(g) = 1 - (α / (μ + α))^α`）に従うと仮定し、リーチカーブを推定する詳細なプロセスが示されています。負の二項分布のパラメータ `α` は、`minimize_scalar` 関数を用いて推定されます。**ステップ3**では、構築されたモデルと定式化された問題に基づいて、**最適なCM出稿量と予算配分を導出**します。これにより、利益を最大化する具体的なCM出稿戦略が導出されます。また、コラムでは、確率分布モデル（例：`R_it ~ Bernoulli(θ_i)`、`θ_i ~ Beta(α, β)`）を用いたシミュレーションを通じて、数理モデルの予測精度や妥当性を検証する方法も紹介されており、実践的な応用への理解を深めます。
    
- **第3章 認知形成を数理モデリングする** この章では、企業が広告を通じて製品認知を高めることを目指す中で、データサイエンスがその目標達成にどのように貢献するかを、**製品認知の形成を数理的にモデリングし、最適化**するアプローチを通じて解説しています。**ステップ1**では、テレビCMの出稿量と製品認知の関係を最大化する**数理最適化問題として定式化**されます。具体的には、製品認知目標を達成するための最小CM出稿量を決定する問題、あるいは与えられた予算の制約下で製品認知率 `Pr(A=1|g)` を最大化する問題（目的関数 `max Pr(A=1|g)`、決定変数 `g`、制約条件 `100kg <= b, g >= 0`）が定義されます。**ステップ2**では、この問題解決に必要な**CM接触回数と製品認知の関係などの未知のパラメータをデータから推定するため、数理モデルが構築**されます。REVISIO社などの実際のデータを使用し、CM接触回数と製品認知率のデータを分析します。機械学習モデルとしては、ランダムフォレストや線形回帰（`Pr(A=1|g) = α + β log(g+1)`）を用いて認知カーブを推定します。さらに、**個人ごとの製品認知メカニズムをベータ分布などの確率分布で表現**し、CM接触回数と製品認知率の複雑な関係をモデル化します。特に、製品を認知している個人のCM接触回数と非認知個人のCM接触回数の比率がベータ分布 `Beta(α, β)` に従うと仮定し、製品認知率 `Pr(A=1|g)` をベータ分布の平均 `μ = α / (α + β)` を用いた積分形式で表現します。また、**FrequencyEstimator**クラスと**AwarenessCurveEstimator**クラスといった独自のPythonクラスが導入され、モデル構築とパラメータ推定の手順が具体的に示されています。**ステップ3**では、これらのモデルと定式化された問題を用いて、**製品認知を最大化するための最適なCM出稿量を導出**します。Scipyの `optimize.minimize` を利用し、コストを考慮しながら認知目標を達成するための最適なCM出稿量が決定されます。
    
- **第4章 連続最適化で広告予算を配分する** この章では、テレビCMやデジタル広告など、複数のメディアにまたがる**広告予算の「連続最適化」配分**について解説されています。主な目標は、総広告費の制約のもとで、**複数のメディアを組み合わせたユニークリーチ（広告到達人数）を最大化**することです。**ステップ1**では、この広告予算配分問題が**数理最適化問題として定式化**されます。各メディアへの出稿量 `g_j` が決定変数となり、全体のユニークリーチ `E[R_{1,2}|g_1, g_2]` が目的関数、総予算 `Σ c_j g_j <= b` が制約条件として定義されます。**ステップ2**では、**各メディアのグロスリーチとユニークリーチの関係、および複数のメディアを組み合わせた際のユニークリーチの関係性をモデル化し、未知のパラメータをデータから推定**します。REVISIO社などの実際のデータを用いて、Random ForestやLinear Regressionといった機械学習モデルを適用し、グロスリーチとユニークリーチの関係、さらにはメディア間のリーチ重複を考慮したモデルを構築します。特に、複数のメディアを組み合わせた際のユニークリーチを `r_{1,2}(g_1, g_2) = r_1(g_1) + r_2(g_2) - r_1(g_1)r_2(g_2)` のような式でモデル化し、メディア間のリーチ重複を考慮した予測を行います。また、**UniqueReachEstimator**や**TotalReachEstimator**といった独自のPythonクラスを用いて、個別メディアおよび複合メディアのリーチ予測を効率的に行います。**ステップ3**では、これらのモデルと定式化された問題に基づいて、**総予算を考慮した最適な広告予算配分を連続的に決定**します。これにより、最も効果的なメディアの組み合わせと出稿量を特定し、Scipyの `optimize.minimize` を活用して広告効果を最大化する戦略が導出されます。
    
- **第5章 離散最適化で広告出稿番組を選択する** この章では、特定のテレビ番組への広告出稿を個別に選択する**「離散最適化」の課題**に焦点を当てています。この章の目的は、与えられた予算制約のもとで、**最も多くのユニークリーチを獲得できる番組の組み合わせを特定**することです。**ステップ1**では、番組選択の課題が**数理最適化問題として定式化**されます。ここでは、各番組への出稿の有無 `d_j ∈ {0, 1}` が決定変数となり、目的関数はユニークリーチ `E[R|d]` の最大化、制約条件は総予算 `Σ c_j d_j <= b` となります。**ステップ2**では、**各番組の出稿がユニークリーチに与える影響、および番組間のリーチ重複を考慮した数理モデルを構築**し、未知のパラメータをデータから推定します。REVISIO社などの実際のデータを用いて、線形回帰、リッジ回帰、ランダムフォレストといった機械学習モデルを適用し、番組ごとのユニークリーチ、そして複数番組同時出稿時のユニークリーチを予測します。また、個人レベルのCM接触確率をモデル化し、その組み合わせからユニークリーチを予測します。複数の番組にCMが接触する際のユニークリーチは `E[R|D] = Σ_{x} Pr(X=x) * (1 - Π_{j=1..m} (1 - Pr(R_j=1|X=x)))` の形式で表現され、**ProgramUniqueReachEstimator**クラスが導入され、モデル構築とパラメータ推定が具体的に示されます。**ステップ3**では、これらのモデルと定式化された問題に基づき、**最適な番組の組み合わせを離散的に選択**します。これは**貪欲法**などの最適化アルゴリズムを用いて行われ、予算制約内でユニークリーチを最大化する番組の組み合わせが探索されます。さらに、コラムでは、**シャプレー値（Shapley value）**を用いて、選択された番組群の中で各番組が全体のユニークリーチにどれだけ貢献したかを定量的に分析する方法も解説されており（シャプレー値 `φ_i` は、あるプレイヤー `i` がゲームに参加した際の貢献度を定量化する概念）、意思決定の根拠を明確化する手法を提供しています。