# 幾何分布 (Geometric Distribution)

#統計

## 概要

幾何分布は、独立なベルヌーイ試行において、最初の成功が起こるまでの失敗の回数をモデル化する際に用いられる離散型確率分布です。「最初の成功までの待ち時間」を表現する分布として重要な役割を持ちます。

## 基本情報

- **種別**: 離散型
- **定義域**: {0, 1, 2, 3, ...}（失敗回数の場合）
- **パラメータ**: p（成功確率、0 < p ≤ 1）

## 数学的性質

### 確率質量関数 (PMF)
$$P(X = n) = (1-p)^n p$$

ここで、pは成功確率、nは最初の成功が起こるまでの失敗の回数（0,1,2,…）です。

### 統計的性質

- **平均（期待値）**: $E[X] = \frac{1-p}{p}$
- **分散**: $\text{Var}[X] = \frac{1-p}{p^2}$
- **標準偏差**: $\sqrt{\frac{1-p}{p^2}}$

注意: 最初の成功までの試行回数を確率変数とする定義では平均は1/pとなります。

## 特徴と性質

### 無記憶性 (Memoryless Property)

幾何分布の最も重要な特徴は「無記憶性」です：

$$P(X > m + n | X > m) = P(X > n)$$

これは、過去の試行結果が未来の確率に影響を与えないという性質を意味します。

### 重要な意味
- 次に成功する確率は常に一定
- 経年劣化や学習効果がない現象に適用可能
- 機械の故障などで、故障率が一定の場合に適用

### 数学的特性

- **再生性**: 幾何分布は再生性を持ちません
- **対称性**: 持ちません（常に右に偏った分布）

## モデリングへの応用

### 適用例

- **機械の故障**: 故障するまでの正常動作回数
- **薬剤耐性**: ウイルスが薬剤耐性を獲得するまでの継代回数
- **営業活動**: 契約が取れるまでの営業回数
- **ゲーム**: 当たりが出るまでの試行回数
- **品質検査**: 不良品が見つかるまでの検査回数

### 使用条件

幾何分布を適用する際の前提条件：
- 各試行が独立
- 成功確率が一定
- 無記憶性が成立する現象

## 他の分布との関係

- **指数分布**: 連続版の幾何分布（連続時間での無記憶性）
- **負の二項分布**: r回の成功までの失敗回数（幾何分布はr=1の特殊ケース）

## 計算例

### 例題
成功確率0.2のゲームで、3回失敗した後に初めて成功する確率は？

$$P(X = 3) = (1-0.2)^3 \times 0.2 = 0.8^3 \times 0.2 = 0.1024$$

## 実装例（概念的）

```python
def geometric_pmf(n, p):
    """幾何分布の確率質量関数"""
    return ((1 - p) ** n) * p

def geometric_properties(p):
    """幾何分布の統計的性質"""
    mean = (1 - p) / p
    variance = (1 - p) / (p ** 2)
    std = (variance) ** 0.5
    
    return {
        'mean': mean,
        'variance': variance,
        'std': std
    }
```

## 参考

詳細な参考文献については[[04_参考文献]]を参照してください。

## 関連項目

- [[02_指数分布]]
- [[01_負の二項分布]]
- [[03_確率分布間の関係性]]
