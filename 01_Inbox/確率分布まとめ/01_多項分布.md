# 多項分布 (Multinomial Distribution)

#統計

## 概要

多項分布は、二項分布を複数のカテゴリに拡張した離散型確率分布であり、複数カテゴリのいずれかに分類される試行を複数回行った際の、各カテゴリの発生回数をモデル化します。

## 基本情報

- **種別**: 離散型
- **定義域**: $\{(x_1, x_2, ..., x_K) : x_i \geq 0, \sum_{i=1}^K x_i = n\}$
- **パラメータ**: 
  - n（試行回数、正の整数）
  - $p_1, p_2, ..., p_K$（各カテゴリの発生確率、$\sum_{i=1}^K p_i = 1$）

## 数学的性質

### 確率質量関数 (PMF)
$$f_X(x) = \frac{n!}{x_1! \cdots x_K!} p_1^{x_1} \cdots p_K^{x_K}$$

ここで、nは試行回数、Kはカテゴリの数、$x = [x_1, ..., x_K]$は各カテゴリの発生回数を表すベクトル（$x_1 + ... + x_K = n$を満たす）、$p_1, ..., p_K$は各カテゴリの発生確率（$p_1 + ... + p_K = 1$を満たす）です。

### 統計的性質

#### 周辺分布
- **平均**: $E[X_i] = np_i$
- **分散**: $\text{Var}[X_i] = np_i(1-p_i)$
- **共分散**: $\text{Cov}[X_i, X_j] = -np_i p_j$ （$i \neq j$）

#### 周辺分布の性質
多項分布のある1つの変数に関する周辺分布は二項分布 $\text{Binomial}(n, p_i)$ になります。

## 特徴と性質

### 二項分布との関係
- **二項分布**: 2つの結果（成功/失敗）を扱う
- **多項分布**: 3つ以上のカテゴリの結果を扱う
- K = 2の場合、多項分布は二項分布と同じになります

### パラメータの制約
- $K-1$ 個の確率が決まれば残りの1つの確率も決まる
- 自由に定められる確率変数は $K-1$ 個

### 数学的特性
- **再生性**: 多項分布は再生性を持ちません
- **対称性**: すべての $p_i$ が等しい場合のみ対称

## モデリングへの応用

### 適用例

#### ゲーム・確率
- **サイコロ**: 複数回振ったときの各数字の出現回数
- **ルーレット**: 各区間への停止回数
- **カードゲーム**: 各スートが出現する回数

#### 社会科学・調査
- **世論調査**: 複数選択肢への回答分布
- **選挙**: 各候補者への投票数
- **アンケート**: 満足度（非常に満足/満足/普通/不満/非常に不満）の分布

#### 自然科学・工学
- **遺伝学**: 複数の表現型の比率
- **品質管理**: 製品の欠陥を複数カテゴリに分類した際の各欠陥の発生数
- **通信**: パケットの宛先分布

#### 言語学・情報科学
- **自然言語処理**: 文書中の特定の単語や品詞の出現回数
- **機械学習**: 多クラス分類問題
- **情報理論**: 文字や記号の出現頻度

### 実世界での例

1. **レストランメニュー**: 100人の客が料理A、B、C、Dを注文する回数
2. **交通調査**: 交差点で左折、直進、右折する車の台数
3. **SNS分析**: 投稿に対する「いいね」「シェア」「コメント」の反応数
4. **医療診断**: 症状を複数カテゴリに分類した際の各症状の発生数

## 特殊ケース

### 2項の場合（K=2）
多項分布は二項分布に帰着：
$$\text{Multinomial}(n; p, 1-p) = \text{Binomial}(n, p)$$

### 一様多項分布
すべてのカテゴリの確率が等しい場合：
$$p_1 = p_2 = ... = p_K = \frac{1}{K}$$

## パラメータ推定

### 最尤推定
観測データから各カテゴリの確率を推定：
$$\hat{p_i} = \frac{x_i}{n}$$

## 計算例

### 例題
サイコロを12回振って、1が3回、2が2回、3が1回、4が2回、5が2回、6が2回出る確率は？

$$P(X_1=3, X_2=2, X_3=1, X_4=2, X_5=2, X_6=2) = \frac{12!}{3!2!1!2!2!2!} \left(\frac{1}{6}\right)^{12} \approx 0.0034$$

## 応用：カイ二乗適合度検定

多項分布は適合度検定の理論的基礎となります：

$$\chi^2 = \sum_{i=1}^K \frac{(O_i - E_i)^2}{E_i}$$

ここで、$O_i$ は観測度数、$E_i$ は期待度数です。

## 実装例（概念的）

```python
import math
from math import factorial

def multinomial_pmf(x_vector, n, p_vector):
    """多項分布の確率質量関数"""
    if sum(x_vector) != n or abs(sum(p_vector) - 1.0) > 1e-10:
        return 0
    
    # 多項係数の計算
    coeff = factorial(n)
    for x_i in x_vector:
        coeff //= factorial(x_i)
    
    # 確率の計算
    prob = 1.0
    for x_i, p_i in zip(x_vector, p_vector):
        prob *= (p_i ** x_i)
    
    return coeff * prob

def multinomial_properties(n, p_vector):
    """多項分布の統計的性質"""
    K = len(p_vector)
    means = [n * p_i for p_i in p_vector]
    variances = [n * p_i * (1 - p_i) for p_i in p_vector]
    
    # 共分散行列
    covariances = {}
    for i in range(K):
        for j in range(i+1, K):
            covariances[(i,j)] = -n * p_vector[i] * p_vector[j]
    
    return {
        'means': means,
        'variances': variances,
        'covariances': covariances
    }
```

## 参考

詳細な参考文献については[[04_参考文献]]を参照してください。

## 関連項目

- [[01_二項分布]]
- [[ディリクレ分布]]（多項分布の共役事前分布）
- [[02_カイ二乗分布]]（適合度検定）
- [[03_確率分布間の関係性]]
