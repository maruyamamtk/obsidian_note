# ベータ分布 (Beta Distribution)

#統計 

## 概要

ベータ分布は、区間 $[0,1]$ で定義される連続型確率分布であり、「成功数 $\alpha$ と失敗数 $\beta$ が明らかなときの成功率」の分布を表現するのに用いられます。ベイズ統計において特に重要な役割を担います。

## 基本情報

**種別**: 連続分布

**確率密度関数**:
$$f(p; \alpha, \beta) = \frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha)\Gamma(\beta)} p^{\alpha-1}(1-p)^{\beta-1}$$

ここで：
- $p$ は確率変数（成功率、$0 \leq p \leq 1$）
- $\alpha, \beta$ は形状パラメータ（成功回数と失敗回数に相当、$\alpha > 0, \beta > 0$）
- $\Gamma(z)$ はガンマ関数

**累積分布関数**:
$$F(p; \alpha, \beta) = I_p(\alpha, \beta)$$
ここで、$I_p(\alpha, \beta)$ は正則化不完全ベータ関数です。

## 数学的性質

**平均（期待値）**: 
$$E[p] = \frac{\alpha}{\alpha + \beta}$$

**分散**: 
$$\text{Var}[p] = \frac{\alpha\beta}{(\alpha + \beta)^2(\alpha + \beta + 1)}$$

**標準偏差**: 
$$\sigma = \sqrt{\frac{\alpha\beta}{(\alpha + \beta)^2(\alpha + \beta + 1)}}$$

**最頻値（モード）**: 
$$\text{mode} = \frac{\alpha - 1}{\alpha + \beta - 2} \quad (\alpha > 1, \beta > 1)$$

## 形状の特徴

ベータ分布は、その形状が非常に柔軟であり、パラメータ $\alpha$ と $\beta$ の値によってグラフの形状が大きく変化します：

### 特殊な場合

- **$\alpha = \beta = 1$**: 標準一様分布 $U(0,1)$ になります
- **$\alpha = \beta > 1$**: 正規分布に似た対称な形状になります
- **$\alpha > \beta$**: 左肩下がり（左偏）のグラフになり、最頻値が平均値より左側に位置
- **$\alpha < \beta$**: 右肩下がり（右偏）のグラフになり、最頻値が平均値より右側に位置
- **$\alpha < 1, \beta > 1$**: 単調減少（J字型）
- **$\alpha > 1, \beta < 1$**: 単調増加（逆J字型）
- **$\alpha < 1, \beta < 1$**: U字型（両端に偏る）

### 対称性

パラメータ $\alpha$ と $\beta$ のベータ分布と、パラメータ $\beta$ と $\alpha$ のベータ分布の確率密度関数の形状は、$p = 0.5$ を中心に対称となります。

## 他の分布との関係

### 一様分布との関係
$\text{Beta}(1, 1) = U(0, 1)$ （標準一様分布）

### 二項分布との共役性
ベータ分布は二項分布の成功確率に対する共役事前分布です。

### ガンマ分布との関係
$$\text{Beta}(\alpha, \beta) = \frac{X}{X + Y}$$
ここで、$X \sim \text{Gamma}(\alpha, 1)$, $Y \sim \text{Gamma}(\beta, 1)$ かつ $X, Y$ は独立。

## 特徴とモデリングへの応用

ベータ分布は、ベイズ統計において特に重要な役割を担っています。これは、成功率や割合といった $0$ から $1$ の間の値をとる確率変数をモデル化する際に、事前確率分布として扱いやすいという特性を持つためです。

### 主な応用例

#### 1. ベイズ統計での事前分布
- 二項分布の成功確率の事前分布として使用
- 観測データに基づく事後分布の更新が解析的に可能

#### 2. 割合・確率の推定
- **Amazonなどのレビュー評価の比較**: 肯定的レビューの割合の推定
- **駄菓子屋のアイスバーの当たりが出る確率の推定**: 当たりくじの確率分析
- **品質管理**: 不良品率の推定
- **マーケティング**: コンバージョン率の分析

#### 3. A/Bテストでの応用
- 異なる施策の効果率の比較
- コンバージョン率の信頼区間推定

#### 4. 生物学・医学分野
- 治療成功率の推定
- 遺伝的多様性の分析

## パラメータ推定

### モーメント法
標本平均 $\bar{p}$ と標本分散 $s^2$ から：
$$\hat{\alpha} = \bar{p} \left( \frac{\bar{p}(1-\bar{p})}{s^2} - 1 \right)$$
$$\hat{\beta} = (1-\bar{p}) \left( \frac{\bar{p}(1-\bar{p})}{s^2} - 1 \right)$$

### 最尤推定
対数尤度関数を最大化することで推定しますが、解析解が存在しないため数値的手法が必要です。

## ベイズ更新

二項分布 $B(n, p)$ において、事前分布 $\text{Beta}(\alpha, \beta)$ から $x$ 回の成功を観測した場合の事後分布は：
$$p | x \sim \text{Beta}(\alpha + x, \beta + n - x)$$

この共役性により、ベイズ推定が簡単に実行できます。

## 数値例

### 例1: $\alpha = 2, \beta = 5$
- 平均: $E[p] = \frac{2}{7} \approx 0.286$
- 分散: $\text{Var}[p] = \frac{10}{49 \times 8} \approx 0.0255$
- 右偏の分布（成功率が低い方に偏る）

### 例2: $\alpha = 5, \beta = 5$
- 平均: $E[p] = 0.5$
- 分散: $\text{Var}[p] = \frac{25}{100 \times 11} \approx 0.0227$
- 対称な分布

## 関連項目

- [[01_二項分布]]: ベータ分布の共役事前分布として使用
- [[02_連続一様分布]]: ベータ分布の特殊ケース
- [[02_ガンマ分布]]: ベータ分布との構成関係
- [[03_確率分布間の関係性]]: 分布間の関係について詳細解説
- [[04_参考文献]]: 詳細な参考文献

[戻る](00_確率分布一覧.md)
