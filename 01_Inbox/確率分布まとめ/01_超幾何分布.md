# 超幾何分布 (Hypergeometric Distribution)

#統計

## 概要

超幾何分布は、有限の母集団から非復元抽出（一度選んだ個体は元に戻さない抽出）を行う場合に、特定の特徴を持つ個体数が標本中に含まれる確率をモデル化する離散型確率分布です。

## 基本情報

- **種別**: 離散型
- **定義域**: {max(0, n-(N-M)), ..., min(n, M)}
- **パラメータ**: 
  - N（母集団の総数）
  - M（母集団中の特定特徴を持つ個体数、アタリの数）
  - n（抽出される標本のサイズ）

## 数学的性質

### 確率質量関数 (PMF)
$$f_X(x) = \frac{\binom{M}{x} \times \binom{N-M}{n-x}}{\binom{N}{n}}$$

ここで、Nは母集団の総数、Mは母集団中の特定の特徴を持つ個体数、nは抽出される標本のサイズ、xは標本中の特定の特徴を持つ個体数です。

### 統計的性質

- **平均（期待値）**: $E[X] = n \frac{M}{N} = np$（ただし、$p = \frac{M}{N}$）
- **分散**: $\text{Var}[X] = \frac{N-n}{N-1} np(1-p)$
- **標準偏差**: $\sqrt{\frac{N-n}{N-1} np(1-p)}$

## 特徴と性質

### 非復元抽出の影響

**有限母集団補正係数**: $\frac{N-n}{N-1}$

この係数により分散が二項分布より小さくなります：
- N >> n の場合：補正係数 ≈ 1（二項分布に近似）
- N ≈ n の場合：補正係数が小さくなる

### 二項分布との違い

| 特徴 | 超幾何分布 | 二項分布 |
|------|------------|----------|
| 抽出方法 | 非復元抽出 | 復元抽出（独立試行） |
| 独立性 | なし | あり |
| 母集団 | 有限 | 無限（または十分大きい） |
| 分散 | 小さくなる | より大きい |

### 数学的特性

- **再生性**: 超幾何分布は再生性を持ちません
- **対称性**: M = N/2 かつ n = N/2 のときのみ対称

## 近似関係

### 二項分布による近似
N が十分大きく、n/N が小さい場合：
$$\text{Hypergeom}(N, M, n) \approx \text{Binomial}(n, M/N)$$

### 正規分布による近似
nが大きく、pが0.5に近い場合：
$$X \approx N\left(np, np(1-p)\frac{N-n}{N-1}\right)$$

## モデリングへの応用

### 適用例

#### 品質管理
- **抜き取り検査**: ロットから製品を取り出して不良品を調べる
- **検査計画**: 合格/不合格の判定

#### ゲーム・確率
- **カードゲーム**: 特定のカードが手札に来る確率
- **くじ引き**: アタリを引く確率
- **宝くじ**: 当選番号の組み合わせ

#### 生態学・生物学
- **捕獲再捕獲法**: 個体数推定（マーク・リキャプチャー法）
- **標本調査**: 希少種の発見確率
- **遺伝学**: 対立遺伝子の頻度

#### 統計的検定
- **Fisherの正確確率検定**: 2×2分割表の検定
- **無作為化検定**: 実験デザインの検定

### 実世界での例

1. **品質検査**: 100個の製品から10個を調べて不良品数を確認
2. **世論調査**: 有限の有権者から標本を抽出
3. **トランプ**: 52枚のカードから5枚引いてスペードの枚数
4. **生態調査**: 池の魚に印をつけて再捕獲による個体数推定

## パラメータの意味

### 実用的解釈

- **N**: 調査対象の全体数
- **M**: 調査対象のうち、興味のある特徴を持つ個体数
- **n**: 実際に調査する標本の大きさ
- **x**: 標本中で特徴を持つ個体数（確率変数）

## 計算例

### 例題
52枚のトランプから5枚引いて、スペードが2枚含まれる確率は？

- N = 52（全カード）
- M = 13（スペード）  
- n = 5（引くカード）
- x = 2（スペードの枚数）

$$P(X = 2) = \frac{\binom{13}{2} \times \binom{39}{3}}{\binom{52}{5}} = \frac{78 \times 9139}{2598960} \approx 0.274$$

## 実装例（概念的）

```python
from math import comb

def hypergeometric_pmf(x, N, M, n):
    """超幾何分布の確率質量関数"""
    return (comb(M, x) * comb(N - M, n - x)) / comb(N, n)

def hypergeometric_properties(N, M, n):
    """超幾何分布の統計的性質"""
    p = M / N
    mean = n * p
    correction_factor = (N - n) / (N - 1)
    variance = n * p * (1 - p) * correction_factor
    std = (variance) ** 0.5
    
    return {
        'mean': mean,
        'variance': variance,
        'std': std,
        'correction_factor': correction_factor
    }

def hypergeom_vs_binomial(N, M, n):
    """二項分布近似の適用可否"""
    if N >= 10 * n and n / N <= 0.1:
        return "二項分布による近似が適用可能"
    return "超幾何分布を使用すべき"
```

## 参考

詳細な参考文献については[[04_参考文献]]を参照してください。

## 関連項目

- [[01_二項分布]]
- [[02_正規分布]]
- [[03_確率分布間の関係性]]
